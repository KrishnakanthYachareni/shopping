(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{lE2P:function(t,e,r){"use strict";r.r(e),r.d(e,"ProductModule",function(){return R});var c=r("tyNb"),i=r("PCNd"),o=r("fXoL"),n=r("tk/3"),d=r("2Vo4"),s=r("LRne"),b=r("HDdC"),a=r("vkgz"),l=r("JIr8");let u=(()=>{class t{constructor(t){this.http=t,this.productsUrl="api/products",this.selectedProductSource=new d.a(null),this.selectedProductChanges$=this.selectedProductSource.asObservable()}changeSelectedProduct(t){this.selectedProductSource.next(t)}getProducts(){return this.products?Object(s.a)(this.products):this.http.get(this.productsUrl).pipe(Object(a.a)(t=>console.log("All Products",JSON.stringify(t))),Object(a.a)(t=>this.products=t),Object(l.a)(this.handleError))}getProduct(t){if(0===t)return Object(s.a)(this.initializeProduct());if(this.products){const e=this.products.find(e=>e.id===t);if(e)return Object(s.a)(e)}return this.http.get(`${this.productsUrl}/${t}`).pipe(Object(a.a)(t=>console.log("Single Product: "+JSON.stringify(t))),Object(l.a)(this.handleError))}saveProduct(t){const e=new n.d({"Content-Type":"application/json"});return 0===t.id?this.createProduct(t,e):this.updateProduct(t,e)}deleteProduct(t){const e=new n.d({"Content-Type":"application/json"});return this.http.delete(`${this.productsUrl}/${t}`,{headers:e}).pipe(Object(a.a)(e=>console.log("deleteProduct: "+t)),Object(a.a)(e=>{const r=this.products.findIndex(e=>e.id===t);r>-1&&(this.products.splice(r,1),this.changeSelectedProduct(null))}),Object(l.a)(this.handleError))}createProduct(t,e){return t.id=null,this.http.post(this.productsUrl,t,{headers:e}).pipe(Object(a.a)(t=>console.log("createProduct: "+JSON.stringify(t))),Object(a.a)(t=>{this.products&&this.products.push(t),this.changeSelectedProduct(t)}),Object(l.a)(this.handleError))}updateProduct(t,e){return this.http.put(`${this.productsUrl}/${t.id}`,t,{headers:e}).pipe(Object(a.a)(e=>console.log("updateProduct: "+t.id)),Object(l.a)(this.handleError))}initializeProduct(){return{id:0,productName:"",productCode:"",category:"",tags:[],releaseDate:"",price:0,description:"",starRating:0,imageUrl:""}}handleError(t){let e;return e=t.error instanceof Error?`An error occurred: ${t.error.message}`:`Backend returned code ${t.status}, body was: ${t.error}`,console.error(t),r=e,new b.a(t=>t.error(r));var r}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(n.b))},t.\u0275prov=o.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=r("ofXK");let g=(()=>{class t{ngOnChanges(){this.starPercent=75*this.rating/5+"px"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Fb({type:t,selectors:[["pm-star"]],inputs:{rating:"rating"},features:[o.zb],decls:7,vars:3,consts:[[1,"crop",3,"title"],[2,"width","75px"],[1,"fa","fa-star"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Mb(2,"span",2),o.Mb(3,"span",2),o.Mb(4,"span",2),o.Mb(5,"span",2),o.Mb(6,"span",2),o.Nb(),o.Nb()),2&t&&(o.jc("width",e.starPercent),o.bc("title",e.rating))},styles:[".crop[_ngcontent-%COMP%]{overflow:hidden}"]}),t})();function h(t,e){if(1&t&&o.Mb(0,"img",15),2&t){const t=o.Xb(2);o.jc("width",200,"px")("margin",2,"px"),o.bc("src",t.product.imageUrl,o.hc)("title",t.product.productName)}}const v=function(t){return["/products",t,"edit"]};function m(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",2),o.Ob(1,"div",3),o.lc(2),o.Nb(),o.Ob(3,"div",4),o.Ob(4,"div",5),o.Ob(5,"div",6),o.Ob(6,"div",5),o.Ob(7,"div",7),o.lc(8,"Name:"),o.Nb(),o.Ob(9,"div",6),o.lc(10),o.Nb(),o.Nb(),o.Ob(11,"div",5),o.Ob(12,"div",7),o.lc(13,"Code:"),o.Nb(),o.Ob(14,"div",6),o.lc(15),o.Yb(16,"lowercase"),o.Nb(),o.Nb(),o.Ob(17,"div",5),o.Ob(18,"div",7),o.lc(19,"Description:"),o.Nb(),o.Ob(20,"div",6),o.lc(21),o.Nb(),o.Nb(),o.Ob(22,"div",5),o.Ob(23,"div",7),o.lc(24,"Availability:"),o.Nb(),o.Ob(25,"div",6),o.lc(26),o.Nb(),o.Nb(),o.Ob(27,"div",5),o.Ob(28,"div",7),o.lc(29,"Price:"),o.Nb(),o.Ob(30,"div",6),o.lc(31),o.Yb(32,"currency"),o.Nb(),o.Nb(),o.Ob(33,"div",5),o.Ob(34,"div",7),o.lc(35,"5 Star Rating:"),o.Nb(),o.Ob(36,"div",6),o.Mb(37,"pm-star",8),o.Nb(),o.Nb(),o.Nb(),o.Ob(38,"div",6),o.kc(39,h,1,6,"img",9),o.Nb(),o.Nb(),o.Ob(40,"div",10),o.Ob(41,"div",11),o.Ob(42,"a",12),o.Vb("click",function(){return o.gc(t),o.Xb().onBack()}),o.Mb(43,"i",13),o.lc(44," Back "),o.Nb(),o.Ob(45,"a",14),o.lc(46," Edit "),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Xb();o.Bb(2),o.nc(" ",t.pageTitle+": "+t.product.productName," "),o.Bb(8),o.mc(t.product.productName),o.Bb(5),o.mc(o.Zb(16,9,t.product.productCode)),o.Bb(6),o.mc(t.product.description),o.Bb(5),o.mc(t.product.releaseDate),o.Bb(5),o.mc(o.ac(32,11,t.product.price,"USD","symbol")),o.Bb(6),o.bc("rating",t.product.starRating),o.Bb(2),o.bc("ngIf",t.product.imageUrl),o.Bb(6),o.bc("routerLink",o.dc(15,v,t.product.id))}}function f(t,e){if(1&t&&(o.Ob(0,"div",16),o.lc(1),o.Nb()),2&t){const t=o.Xb();o.Bb(1),o.nc(" Error: ",t.errorMessage,"\n")}}let O=(()=>{class t{constructor(t,e,r){this.productService=t,this.router=e,this.route=r,this.pageTitle="Product Detail"}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");t&&this.getProduct(+t)}getProduct(t){this.productService.getProduct(t).subscribe({next:t=>this.product=t,error:t=>this.errorMessage=t})}onBack(){this.router.navigate(["/products"])}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(u),o.Lb(c.b),o.Lb(c.a))},t.\u0275cmp=o.Fb({type:t,selectors:[["ng-component"]],decls:2,vars:2,consts:[["class","card",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-6"],[1,"col-md-3"],[3,"rating"],["class","center-block img-responsive",3,"width","margin","src","title",4,"ngIf"],[1,"row","mt-4"],[1,"col-md-4"],[1,"btn","btn-outline-secondary","mr-3",2,"width","80px",3,"click"],[1,"fa","fa-chevron-left"],[1,"btn","btn-primary",2,"width","80px",3,"routerLink"],[1,"center-block","img-responsive",3,"src","title"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(o.kc(0,m,47,17,"div",0),o.kc(1,f,2,1,"div",1)),2&t&&(o.bc("ngIf",e.product),o.Bb(1),o.bc("ngIf",e.errorMessage))},directives:[p.l,g,c.e],pipes:[p.i,p.c],styles:[""]}),t})();var N=r("3Pt+");function P(t,e){1&t&&(o.Ob(0,"span"),o.lc(1," Product name is required. "),o.Nb())}function y(t,e){1&t&&(o.Ob(0,"span"),o.lc(1," Product name must be at least three characters. "),o.Nb())}function w(t,e){1&t&&(o.Ob(0,"span"),o.lc(1," Product code is required. "),o.Nb())}const C=function(t){return{"is-invalid":t}};function k(t,e){if(1&t){const t=o.Pb();o.Ob(0,"fieldset"),o.Ob(1,"div",6),o.Ob(2,"label",7),o.lc(3,"Product Name"),o.Nb(),o.Ob(4,"div",8),o.Ob(5,"input",9,10),o.Vb("ngModelChange",function(e){return o.gc(t),o.Xb().product.productName=e}),o.Nb(),o.Ob(7,"span",11),o.kc(8,P,2,0,"span",4),o.kc(9,y,2,0,"span",4),o.Nb(),o.Nb(),o.Nb(),o.Ob(10,"div",6),o.Ob(11,"label",12),o.lc(12,"Product Code"),o.Nb(),o.Ob(13,"div",8),o.Ob(14,"input",13,14),o.Vb("ngModelChange",function(e){return o.gc(t),o.Xb().product.productCode=e}),o.Nb(),o.Ob(16,"span",11),o.kc(17,w,2,0,"span",4),o.Nb(),o.Nb(),o.Nb(),o.Ob(18,"div",6),o.Ob(19,"label",15),o.lc(20,"Description"),o.Nb(),o.Ob(21,"div",8),o.Ob(22,"textarea",16),o.Vb("ngModelChange",function(e){return o.gc(t),o.Xb().product.description=e}),o.lc(23,"                        "),o.Nb(),o.Nb(),o.Nb(),o.Ob(24,"div",6),o.Ob(25,"div",17),o.Ob(26,"button",18),o.lc(27," Save "),o.Nb(),o.Ob(28,"a",19),o.Vb("click",function(){return o.gc(t),o.Xb().cancel()}),o.lc(29," Cancel "),o.Nb(),o.Ob(30,"a",20),o.Vb("click",function(){return o.gc(t),o.Xb().deleteProduct()}),o.lc(31," Delete "),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.fc(6),e=o.fc(15),r=o.Xb();o.Bb(5),o.bc("ngModel",r.product.productName)("ngClass",o.dc(9,C,(t.touched||t.dirty||0!==r.product.id)&&!t.valid)),o.Bb(3),o.bc("ngIf",null==t.errors?null:t.errors.required),o.Bb(1),o.bc("ngIf",null==t.errors?null:t.errors.minlength),o.Bb(5),o.bc("ngModel",r.product.productCode)("ngClass",o.dc(11,C,(e.touched||e.dirty||0!==r.product.id)&&!e.valid)),o.Bb(3),o.bc("ngIf",null==e.errors?null:e.errors.required),o.Bb(5),o.bc("ngModel",r.product.description),o.Bb(4),o.bc("disabled",!(null!=r.editForm&&r.editForm.valid))}}function M(t,e){if(1&t&&(o.Ob(0,"div",21),o.lc(1),o.Nb()),2&t){const t=o.Xb();o.Bb(1),o.nc(" Error: ",t.errorMessage,"\n")}}let B=(()=>{class t{constructor(t,e,r){this.productService=t,this.router=e,this.route=r,this.pageTitle="Product Edit"}get isDirty(){return!!this.editForm.dirty}ngOnInit(){this.route.params.subscribe(t=>{this.getProduct(+t.id)})}getProduct(t){this.productService.getProduct(t).subscribe({next:t=>this.onProductRetrieved(t),error:t=>this.errorMessage=t})}onProductRetrieved(t){this.editForm.reset(),this.originalProduct=t,this.product=Object.assign({},t),this.pageTitle=0===this.product.id?"Add Product":`Edit Product: ${this.product.productName}`}cancel(){this.router.navigate(["/products"])}deleteProduct(){this.product.id?confirm(`Really delete the product: ${this.product.productName}?`)&&this.productService.deleteProduct(this.product.id).subscribe({next:()=>this.onSaveComplete(),error:t=>this.errorMessage=t}):this.onSaveComplete()}saveProduct(){this.editForm.valid?this.productService.saveProduct(this.product).subscribe({next:()=>{Object.keys(this.product).forEach(t=>this.originalProduct[t]=this.product[t]),this.onSaveComplete()},error:t=>this.errorMessage=t}):this.errorMessage="Please correct the validation errors."}onSaveComplete(){this.editForm.reset(this.editForm.value),this.router.navigate(["/products"])}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(u),o.Lb(c.b),o.Lb(c.a))},t.\u0275cmp=o.Fb({type:t,selectors:[["ng-component"]],viewQuery:function(t,e){if(1&t&&o.pc(N.f,3),2&t){let t;o.ec(t=o.Wb())&&(e.editForm=t.first)}},decls:7,vars:3,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],["novalidate","",3,"ngSubmit"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"form-group","row"],["for","productNameId",1,"col-md-2","col-form-label"],[1,"col-md-8"],["id","productNameId","type","text","placeholder","Name (required)","required","","minlength","3","name","productName",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["productNameVar","ngModel"],[1,"invalid-feedback"],["for","productCodeId",1,"col-md-2","col-form-label"],["id","productCodeId","type","text","placeholder","Code (required)","required","","name","productCode",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["productCodeVar","ngModel"],["for","descriptionId",1,"col-md-2","col-form-label"],["id","descriptionId","placeholder","Description","rows","3","name","description",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-md-4","col-md-offset-2"],["type","submit",1,"btn","btn-primary","mr-2",2,"width","80px",3,"disabled"],[1,"btn","btn-light","mr-2",2,"width","80px",3,"click"],[1,"btn","btn-light",2,"width","80px",3,"click"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.lc(2),o.Nb(),o.Ob(3,"div",2),o.Ob(4,"form",3),o.Vb("ngSubmit",function(){return e.saveProduct()}),o.kc(5,k,32,13,"fieldset",4),o.Nb(),o.Nb(),o.Nb(),o.kc(6,M,2,1,"div",5)),2&t&&(o.Bb(2),o.nc(" ",e.pageTitle," "),o.Bb(3),o.bc("ngIf",e.product),o.Bb(1),o.bc("ngIf",e.errorMessage))},directives:[N.i,N.e,N.f,p.l,N.a,N.h,N.c,N.d,N.g,p.j],styles:[""]}),t})(),I=(()=>{class t{canDeactivate(t){return!t.isDirty||confirm(`Navigate away and lose all changes to ${t.product.productName||"New Product"}?`)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const S=function(t){return{active:t}};function j(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",7),o.Vb("click",function(){o.gc(t);const r=e.$implicit;return o.Xb(2).onSelected(r)}),o.lc(1),o.Nb()}if(2&t){const t=e.$implicit,r=o.Xb(2);o.bc("ngClass",o.dc(3,S,(null==t?null:t.id)===(null==r.selectedProduct?null:r.selectedProduct.id))),o.Bb(1),o.oc(" ",t.productName," (",t.productCode,") ")}}function D(t,e){if(1&t&&(o.Ob(0,"div",4),o.Ob(1,"div",5),o.kc(2,j,2,5,"button",6),o.Nb(),o.Nb()),2&t){const t=o.Xb();o.Bb(2),o.bc("ngForOf",t.products)}}function x(t,e){if(1&t&&(o.Ob(0,"div",8),o.lc(1),o.Nb()),2&t){const t=o.Xb();o.Bb(1),o.nc(" Error: ",t.errorMessage,"\n")}}let X=(()=>{class t{constructor(t){this.productService=t,this.pageTitle="Products"}ngOnInit(){this.sub=this.productService.selectedProductChanges$.subscribe(t=>this.selectedProduct=t),this.productService.getProducts().subscribe({next:t=>{this.products=t},error:t=>this.errorMessage=t})}onSelected(t){this.productService.changeSelectedProduct(t)}ngOnDestroy(){this.sub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(u))},t.\u0275cmp=o.Fb({type:t,selectors:[["pm-product-shell-list"]],decls:5,vars:3,consts:[[1,"card"],[1,"card-header"],["class","card-body",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"card-body"],[1,"list-group"],["type","button","class","list-group-item",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button",1,"list-group-item",3,"ngClass","click"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.lc(2),o.Nb(),o.kc(3,D,3,1,"div",2),o.Nb(),o.kc(4,x,2,1,"div",3)),2&t&&(o.Bb(2),o.nc(" ",e.pageTitle," "),o.Bb(1),o.bc("ngIf",null==e.products?null:e.products.length),o.Bb(1),o.bc("ngIf",e.errorMessage))},directives:[p.l,p.k,p.j],encapsulation:2}),t})();function F(t,e){if(1&t&&o.Mb(0,"img",13),2&t){const t=o.Xb(2);o.jc("width",200,"px")("margin",2,"px"),o.bc("src",t.product.imageUrl,o.hc)("title",t.product.productName)}}const $=function(t){return["/products",t,"edit"]};function E(t,e){if(1&t&&(o.Ob(0,"div",2),o.Ob(1,"div",3),o.lc(2),o.Nb(),o.Ob(3,"div",4),o.Ob(4,"div",5),o.Ob(5,"div",6),o.Ob(6,"div",5),o.Ob(7,"div",7),o.lc(8,"Name:"),o.Nb(),o.Ob(9,"div",8),o.lc(10),o.Nb(),o.Nb(),o.Ob(11,"div",5),o.Ob(12,"div",7),o.lc(13,"Code:"),o.Nb(),o.Ob(14,"div",8),o.lc(15),o.Nb(),o.Nb(),o.Ob(16,"div",5),o.Ob(17,"div",7),o.lc(18,"Description:"),o.Nb(),o.Ob(19,"div",8),o.lc(20),o.Nb(),o.Nb(),o.Ob(21,"div",5),o.Ob(22,"div",7),o.lc(23,"Availability:"),o.Nb(),o.Ob(24,"div",8),o.lc(25),o.Nb(),o.Nb(),o.Ob(26,"div",5),o.Ob(27,"div",7),o.lc(28,"Price:"),o.Nb(),o.Ob(29,"div",8),o.lc(30),o.Yb(31,"currency"),o.Nb(),o.Nb(),o.Ob(32,"div",5),o.Ob(33,"div",7),o.lc(34,"5 Star Rating:"),o.Nb(),o.Ob(35,"div",8),o.Mb(36,"pm-star",9),o.Nb(),o.Nb(),o.Nb(),o.Ob(37,"div",7),o.kc(38,F,1,6,"img",10),o.Nb(),o.Nb(),o.Ob(39,"div",11),o.Ob(40,"div",7),o.Ob(41,"a",12),o.lc(42," Edit "),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.Xb();o.Bb(2),o.nc(" Product Detail: ",t.product.productName," "),o.Bb(8),o.mc(t.product.productName),o.Bb(5),o.mc(t.product.productCode),o.Bb(5),o.mc(t.product.description),o.Bb(5),o.mc(t.product.releaseDate),o.Bb(5),o.mc(o.ac(31,9,t.product.price,"USD","symbol")),o.Bb(6),o.bc("rating",t.product.starRating),o.Bb(2),o.bc("ngIf",t.product.imageUrl),o.Bb(3),o.bc("routerLink",o.dc(13,$,t.product.id))}}function L(t,e){if(1&t&&(o.Ob(0,"div",14),o.lc(1),o.Nb()),2&t){const t=o.Xb();o.Bb(1),o.nc(" Error: ",t.errorMessage,"\n")}}let U=(()=>{class t{constructor(t){this.productService=t,this.pageTitle="Product Detail"}ngOnInit(){this.sub=this.productService.selectedProductChanges$.subscribe({next:t=>{this.product=t},error:t=>this.errorMessage=t})}ngOnDestroy(){this.sub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(u))},t.\u0275cmp=o.Fb({type:t,selectors:[["pm-product-shell-detail"]],decls:2,vars:2,consts:[["class","card",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-8"],[1,"col-md-4"],[1,"col-md-6"],[3,"rating"],["class","center-block img-responsive",3,"width","margin","src","title",4,"ngIf"],[1,"row","mt-4"],[1,"btn","btn-primary",2,"width","80px",3,"routerLink"],[1,"center-block","img-responsive",3,"src","title"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(o.kc(0,E,43,15,"div",0),o.kc(1,L,2,1,"div",1)),2&t&&(o.bc("ngIf",e.product),o.Bb(1),o.bc("ngIf",e.errorMessage))},directives:[p.l,g,c.e],pipes:[p.c],encapsulation:2}),t})();function T(t,e){if(1&t&&(o.Ob(0,"div",1),o.Ob(1,"div",4),o.lc(2),o.Nb(),o.Nb()),2&t){const t=o.Xb();o.Bb(2),o.nc(" Number of months on the market: ",t.monthCount," ")}}let V=(()=>{class t{constructor(t){this.productService=t,this.pageTitle="Products"}ngOnInit(){this.sub=this.productService.selectedProductChanges$.subscribe(t=>{if(t){const e=new Date(t.releaseDate),r=new Date;this.monthCount=r.getMonth()-e.getMonth()+12*(r.getFullYear()-e.getFullYear())}else this.monthCount=0})}ngOnDestroy(){this.sub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(u))},t.\u0275cmp=o.Fb({type:t,selectors:[["ng-component"]],decls:6,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-md-4"],[1,"col-md-8"],[1,"col-md-4","mt-1"]],template:function(t,e){1&t&&(o.kc(0,T,3,1,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Mb(3,"pm-product-shell-list"),o.Nb(),o.Ob(4,"div",3),o.Mb(5,"pm-product-shell-detail"),o.Nb(),o.Nb()),2&t&&o.bc("ngIf",e.monthCount)},directives:[p.l,X,U],encapsulation:2}),t})(),R=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.Jb({type:t}),t.\u0275inj=o.Ib({imports:[[i.a,c.f.forChild([{path:"",component:V},{path:":id",component:O},{path:":id/edit",canDeactivate:[I],component:B}])]]}),t})()}}]);